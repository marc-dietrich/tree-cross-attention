query-shape: torch.Size([1024, 2, 64])
key-shape: torch.Size([1024, 2, 64])
value-shape: torch.Size([1024, 2, 64])
q-shape: torch.Size([1024, 2, 64])
k-shape: torch.Size([1024, 2, 64])
v-shape: torch.Size([1024, 2, 64])
qu-shape: torch.Size([4096, 2, 16])
ku-shape: torch.Size([4096, 2, 16])
vu-shape: torch.Size([4096, 2, 16])
sim-shape: torch.Size([4096, 2, 2])

query-shape: torch.Size([512, 2, 64])
key-shape: torch.Size([512, 2, 64])
value-shape: torch.Size([512, 2, 64])
q-shape: torch.Size([512, 2, 64])
k-shape: torch.Size([512, 2, 64])
v-shape: torch.Size([512, 2, 64])
qu-shape: torch.Size([2048, 2, 16])
ku-shape: torch.Size([2048, 2, 16])
vu-shape: torch.Size([2048, 2, 16])
sim-shape: torch.Size([2048, 2, 2])

query-shape: torch.Size([256, 2, 64])
key-shape: torch.Size([256, 2, 64])
value-shape: torch.Size([256, 2, 64])
q-shape: torch.Size([256, 2, 64])
k-shape: torch.Size([256, 2, 64])
v-shape: torch.Size([256, 2, 64])
qu-shape: torch.Size([1024, 2, 16])
ku-shape: torch.Size([1024, 2, 16])
vu-shape: torch.Size([1024, 2, 16])
sim-shape: torch.Size([1024, 2, 2])

query-shape: torch.Size([128, 2, 64])
key-shape: torch.Size([128, 2, 64])
value-shape: torch.Size([128, 2, 64])
q-shape: torch.Size([128, 2, 64])
k-shape: torch.Size([128, 2, 64])
v-shape: torch.Size([128, 2, 64])
qu-shape: torch.Size([512, 2, 16])
ku-shape: torch.Size([512, 2, 16])
vu-shape: torch.Size([512, 2, 16])
sim-shape: torch.Size([512, 2, 2])

query-shape: torch.Size([64, 2, 64])
key-shape: torch.Size([64, 2, 64])
value-shape: torch.Size([64, 2, 64])
q-shape: torch.Size([64, 2, 64])
k-shape: torch.Size([64, 2, 64])
v-shape: torch.Size([64, 2, 64])
qu-shape: torch.Size([256, 2, 16])
ku-shape: torch.Size([256, 2, 16])
vu-shape: torch.Size([256, 2, 16])
sim-shape: torch.Size([256, 2, 2])

query-shape: torch.Size([32, 2, 64])
key-shape: torch.Size([32, 2, 64])
value-shape: torch.Size([32, 2, 64])
q-shape: torch.Size([32, 2, 64])
k-shape: torch.Size([32, 2, 64])
v-shape: torch.Size([32, 2, 64])
qu-shape: torch.Size([128, 2, 16])
ku-shape: torch.Size([128, 2, 16])
vu-shape: torch.Size([128, 2, 16])
sim-shape: torch.Size([128, 2, 2])

query-shape: torch.Size([16, 2, 64])
key-shape: torch.Size([16, 2, 64])
value-shape: torch.Size([16, 2, 64])
q-shape: torch.Size([16, 2, 64])
k-shape: torch.Size([16, 2, 64])
v-shape: torch.Size([16, 2, 64])
qu-shape: torch.Size([64, 2, 16])
ku-shape: torch.Size([64, 2, 16])
vu-shape: torch.Size([64, 2, 16])
sim-shape: torch.Size([64, 2, 2])

train tree data shapes: [(torch.Size([16, 64]), torch.Size([16, 1])), (torch.Size([16, 2, 64]), torch.Size([16, 2, 1])), (torch.Size([16, 2, 2, 64]), torch.Size([16, 2, 2, 1])), (torch.Size([16, 2, 2, 2, 64]), torch.Size([16, 2, 2, 2, 1])), (torch.Size([16, 2, 2, 2, 2, 64]), torch.Size([16, 2, 2, 2, 2, 1])), (torch.Size([16, 2, 2, 2, 2, 2, 64]), torch.Size([16, 2, 2, 2, 2, 2, 1])), (torch.Size([16, 2, 2, 2, 2, 2, 2, 64]), torch.Size([16, 2, 2, 2, 2, 2, 2, 1])), (torch.Size([16, 2, 2, 2, 2, 2, 2, 2, 64]), torch.Size([16, 2, 2, 2, 2, 2, 2, 2, 1]))]
B M D 16 128 64
0 iteration query input shapes:  torch.Size([2048, 1, 64]) torch.Size([2048, 2, 64])
query-shape: torch.Size([2048, 1, 64])
key-shape: torch.Size([2048, 2, 64])
value-shape: torch.Size([2048, 2, 64])
q-shape: torch.Size([2048, 1, 64])
k-shape: torch.Size([2048, 2, 64])
v-shape: torch.Size([2048, 2, 64])
qu-shape: torch.Size([8192, 1, 16])
ku-shape: torch.Size([8192, 2, 16])
vu-shape: torch.Size([8192, 2, 16])
sim-shape: torch.Size([8192, 1, 2])

1 iteration query input shapes:  torch.Size([2048, 1, 64]) torch.Size([2048, 2, 64])
query-shape: torch.Size([2048, 1, 64])
key-shape: torch.Size([2048, 2, 64])
value-shape: torch.Size([2048, 2, 64])
q-shape: torch.Size([2048, 1, 64])
k-shape: torch.Size([2048, 2, 64])
v-shape: torch.Size([2048, 2, 64])
qu-shape: torch.Size([8192, 1, 16])
ku-shape: torch.Size([8192, 2, 16])
vu-shape: torch.Size([8192, 2, 16])
sim-shape: torch.Size([8192, 1, 2])

2 iteration query input shapes:  torch.Size([2048, 1, 64]) torch.Size([2048, 2, 64])
query-shape: torch.Size([2048, 1, 64])
key-shape: torch.Size([2048, 2, 64])
value-shape: torch.Size([2048, 2, 64])
q-shape: torch.Size([2048, 1, 64])
k-shape: torch.Size([2048, 2, 64])
v-shape: torch.Size([2048, 2, 64])
qu-shape: torch.Size([8192, 1, 16])
ku-shape: torch.Size([8192, 2, 16])
vu-shape: torch.Size([8192, 2, 16])
sim-shape: torch.Size([8192, 1, 2])

3 iteration query input shapes:  torch.Size([2048, 1, 64]) torch.Size([2048, 2, 64])
query-shape: torch.Size([2048, 1, 64])
key-shape: torch.Size([2048, 2, 64])
value-shape: torch.Size([2048, 2, 64])
q-shape: torch.Size([2048, 1, 64])
k-shape: torch.Size([2048, 2, 64])
v-shape: torch.Size([2048, 2, 64])
qu-shape: torch.Size([8192, 1, 16])
ku-shape: torch.Size([8192, 2, 16])
vu-shape: torch.Size([8192, 2, 16])
sim-shape: torch.Size([8192, 1, 2])

4 iteration query input shapes:  torch.Size([2048, 1, 64]) torch.Size([2048, 2, 64])
query-shape: torch.Size([2048, 1, 64])
key-shape: torch.Size([2048, 2, 64])
value-shape: torch.Size([2048, 2, 64])
q-shape: torch.Size([2048, 1, 64])
k-shape: torch.Size([2048, 2, 64])
v-shape: torch.Size([2048, 2, 64])
qu-shape: torch.Size([8192, 1, 16])
ku-shape: torch.Size([8192, 2, 16])
vu-shape: torch.Size([8192, 2, 16])
sim-shape: torch.Size([8192, 1, 2])

5 iteration query input shapes:  torch.Size([2048, 1, 64]) torch.Size([2048, 2, 64])
query-shape: torch.Size([2048, 1, 64])
key-shape: torch.Size([2048, 2, 64])
value-shape: torch.Size([2048, 2, 64])
q-shape: torch.Size([2048, 1, 64])
k-shape: torch.Size([2048, 2, 64])
v-shape: torch.Size([2048, 2, 64])
qu-shape: torch.Size([8192, 1, 16])
ku-shape: torch.Size([8192, 2, 16])
vu-shape: torch.Size([8192, 2, 16])
sim-shape: torch.Size([8192, 1, 2])

query-shape: torch.Size([2048, 1, 64])
key-shape: torch.Size([2048, 14, 64])
value-shape: torch.Size([2048, 14, 64])
q-shape: torch.Size([2048, 1, 64])
k-shape: torch.Size([2048, 14, 64])
v-shape: torch.Size([2048, 14, 64])
qu-shape: torch.Size([8192, 1, 16])
ku-shape: torch.Size([8192, 14, 16])
vu-shape: torch.Size([8192, 14, 16])
sim-shape: torch.Size([8192, 1, 14])

